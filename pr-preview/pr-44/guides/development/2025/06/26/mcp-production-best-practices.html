<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Learn essential best practices, security considerations, and performance optimization techniques for building robust MCP servers in production environments.">
  <meta name="keywords" content="docker, mcp, model, context, protocol, servers, tools, community">
  <title>Best Practices for Building Production-Ready MCP Servers - MCP Community Portal</title>
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/pr-preview/pr-44/assets/images/docker-logo.svg">
  
  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Custom CSS -->
  <link rel="stylesheet" href="/pr-preview/pr-44/assets/css/main.css">
  <link rel="stylesheet" href="/pr-preview/pr-44/assets/css/tools.css">
  <link rel="stylesheet" href="/pr-preview/pr-44/assets/css/home.css">
  <link rel="stylesheet" href="/pr-preview/pr-44/assets/css/lab-styles.css">
  <link rel="stylesheet" href="/pr-preview/pr-44/assets/css/code-fix.css">
  <link rel="stylesheet" href="/pr-preview/pr-44/assets/css/banner-fix.css">
  <link rel="stylesheet" href="/pr-preview/pr-44/assets/css/image-fix.css">
  <link rel="stylesheet" href="/pr-preview/pr-44/assets/css/heading-fix.css">
  <link rel="stylesheet" href="/pr-preview/pr-44/assets/css/header-fix.css">
  <link rel="stylesheet" href="/pr-preview/pr-44/assets/css/github-stars.css">
  <link rel="stylesheet" href="/pr-preview/pr-44/assets/css/docker-downloads.css">
  
  <!-- Syntax Highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
  
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Best Practices for Building Production-Ready MCP Servers | MCP Community Portal</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Best Practices for Building Production-Ready MCP Servers" />
<meta name="author" content="Alex Chen" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Learn essential best practices, security considerations, and performance optimization techniques for building robust MCP servers in production environments." />
<meta property="og:description" content="Learn essential best practices, security considerations, and performance optimization techniques for building robust MCP servers in production environments." />
<link rel="canonical" href="https://mcp.collabnix.com/pr-preview/pr-44/guides/development/2025/06/26/mcp-production-best-practices.html" />
<meta property="og:url" content="https://mcp.collabnix.com/pr-preview/pr-44/guides/development/2025/06/26/mcp-production-best-practices.html" />
<meta property="og:site_name" content="MCP Community Portal" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-06-26T10:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Best Practices for Building Production-Ready MCP Servers" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Alex Chen"},"dateModified":"2025-06-26T10:00:00+00:00","datePublished":"2025-06-26T10:00:00+00:00","description":"Learn essential best practices, security considerations, and performance optimization techniques for building robust MCP servers in production environments.","headline":"Best Practices for Building Production-Ready MCP Servers","mainEntityOfPage":{"@type":"WebPage","@id":"https://mcp.collabnix.com/pr-preview/pr-44/guides/development/2025/06/26/mcp-production-best-practices.html"},"url":"https://mcp.collabnix.com/pr-preview/pr-44/guides/development/2025/06/26/mcp-production-best-practices.html"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
  <header class="site-header">
  <div class="container">
    <div class="header-content">
      <div class="logo">
        <a href="/pr-preview/pr-44/">
          <h1>MCP Community Portal</h1>
        </a>
      </div>
      <nav class="main-nav">
        <ul>
          <li><a href="/pr-preview/pr-44/"><i class="fas fa-home"></i> Home</a></li>
          <li><a href="/pr-preview/pr-44/categories/getting-started"><i class="fas fa-rocket"></i> Getting Started</a></li>
          <li><a href="/pr-preview/pr-44/categories/mcp-servers"><i class="fas fa-server"></i> Servers</a></li>
          <li><a href="/pr-preview/pr-44/categories/mcp-tools"><i class="fas fa-tools"></i> Tools</a></li>
          <li><a href="/pr-preview/pr-44/labs/01-getting-started/README.html"><i class="fas fa-flask"></i> Labs</a></li>
          <li><a href="/pr-preview/pr-44/blog/"><i class="fas fa-blog"></i> Blog</a></li>
        </ul>
      </nav>
    </div>
  </div>
</header>
  
  <main>
    <article class="modern-post">
  <!-- Hero Section -->
  <header class="post-hero">
    <div class="post-hero-content">
      <div class="post-breadcrumbs">
        <a href="/">Home</a>
        <span>→</span>
        <a href="/blog">Blog</a>
        <span>→</span>
        
        <a href="/categories/guides">guides</a>
        <span>→</span>
        
        <span>Best Practices for Building Production-Ready MCP Servers</span>
      </div>
      
      <div class="post-meta-header">
        
        <span class="post-category-badge">GUIDES</span>
        
        <time class="post-date" datetime="2025-06-26 10:00:00 +0000">June 26, 2025</time>
      </div>
      
      <h1 class="post-title">Best Practices for Building Production-Ready MCP Servers</h1>
      
      
      <p class="post-subtitle">Learn essential best practices, security considerations, and performance optimization techniques for building robust MCP servers in production environments.</p>
      
      
      <div class="post-author-info">
        <div class="author-avatar">
          <img src="/pr-preview/pr-44/assets/images/authors/alex-chen.jpg" 
               alt="Alex Chen" loading="lazy">
        </div>
        <div class="author-details">
          <span class="author-name">Alex Chen</span>
          <span class="author-role">Senior MCP Developer</span>
          <div class="post-stats">
            <span class="read-time">7 min read</span>
            <span class="word-count">1319 words</span>
          </div>
        </div>
      </div>
    </div>
    
    
    <div class="post-featured-image">
      <img src="/pr-preview/pr-44/assets/images/posts/mcp-production-best-practices.jpg" alt="Best Practices for Building Production-Ready MCP Servers" loading="lazy">
    </div>
    
  </header>

  <!-- Content Section -->
  <div class="post-content-wrapper">
    <!-- Table of Contents -->
    <nav class="table-of-contents">
      <h4>Table of Contents</h4>
      <div id="toc-content">
        <!-- Generated by JavaScript -->
      </div>
    </nav>

    <!-- Main Content -->
    <div class="post-content">
      <p>Building Model Context Protocol (MCP) servers for production environments requires careful consideration of security, performance, error handling, and maintainability. In this comprehensive guide, we’ll explore the essential best practices that will help you create robust, scalable MCP servers ready for real-world deployment.</p>

<h2 id="security-fundamentals">Security Fundamentals</h2>

<h3 id="authentication-and-authorization">Authentication and Authorization</h3>

<p>One of the most critical aspects of production MCP servers is implementing proper authentication and authorization mechanisms. Never expose MCP servers without proper security controls.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">mcp</span> <span class="kn">import</span> <span class="n">Server</span>
<span class="kn">from</span> <span class="nn">mcp.middleware</span> <span class="kn">import</span> <span class="n">AuthMiddleware</span>

<span class="k">def</span> <span class="nf">validate_api_key</span><span class="p">(</span><span class="n">api_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="s">"""Validate API key against your authentication system"""</span>
    <span class="n">expected_key</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"MCP_API_KEY"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">api_key</span> <span class="o">==</span> <span class="n">expected_key</span>

<span class="c1"># Apply authentication middleware
</span><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s">"my-production-server"</span><span class="p">)</span>
<span class="n">server</span><span class="p">.</span><span class="n">add_middleware</span><span class="p">(</span><span class="n">AuthMiddleware</span><span class="p">(</span><span class="n">validate_api_key</span><span class="p">))</span>
</code></pre></div></div>

<h3 id="input-validation-and-sanitization">Input Validation and Sanitization</h3>

<p>Always validate and sanitize all inputs to prevent injection attacks and unexpected behavior:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">validator</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="k">class</span> <span class="nc">ToolInput</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
    
    <span class="o">@</span><span class="n">validator</span><span class="p">(</span><span class="s">'query'</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_query</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">'Query cannot be empty'</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">'Query too long'</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span>
    
    <span class="o">@</span><span class="n">validator</span><span class="p">(</span><span class="s">'max_results'</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_max_results</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">):</span>
            <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">'max_results must be between 1 and 100'</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>
</code></pre></div></div>

<h2 id="performance-optimization">Performance Optimization</h2>

<h3 id="connection-pooling-and-resource-management">Connection Pooling and Resource Management</h3>

<p>Implement proper connection pooling for database and external API connections:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">aiohttp</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">asynccontextmanager</span>

<span class="k">class</span> <span class="nc">ProductionMCPServer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">http_session</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">db_pool</span> <span class="o">=</span> <span class="bp">None</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">startup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""Initialize resources on startup"""</span>
        <span class="n">connector</span> <span class="o">=</span> <span class="n">aiohttp</span><span class="p">.</span><span class="n">TCPConnector</span><span class="p">(</span>
            <span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">limit_per_host</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">keepalive_timeout</span><span class="o">=</span><span class="mi">30</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">http_session</span> <span class="o">=</span> <span class="n">aiohttp</span><span class="p">.</span><span class="n">ClientSession</span><span class="p">(</span><span class="n">connector</span><span class="o">=</span><span class="n">connector</span><span class="p">)</span>
        
        <span class="c1"># Initialize database connection pool
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">db_pool</span> <span class="o">=</span> <span class="k">await</span> <span class="n">create_db_pool</span><span class="p">(</span>
            <span class="n">min_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="n">max_size</span><span class="o">=</span><span class="mi">20</span>
        <span class="p">)</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""Clean up resources on shutdown"""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">http_session</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="p">.</span><span class="n">http_session</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">db_pool</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="p">.</span><span class="n">db_pool</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="caching-strategies">Caching Strategies</h3>

<p>Implement intelligent caching to reduce latency and external API calls:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="k">class</span> <span class="nc">CacheManager</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_expiry</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">_cache</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">_expiry</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Cache expired, remove
</span>                <span class="k">del</span> <span class="bp">self</span><span class="p">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">del</span> <span class="bp">self</span><span class="p">.</span><span class="n">_expiry</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">None</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">ttl_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_expiry</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">ttl_seconds</span><span class="p">)</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">clear_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""Background task to clear expired cache entries"""</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">expired_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">_expiry</span><span class="p">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">now</span> <span class="o">&gt;=</span> <span class="n">exp</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">expired_keys</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="p">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">del</span> <span class="bp">self</span><span class="p">.</span><span class="n">_expiry</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</code></pre></div></div>

<h2 id="error-handling-and-resilience">Error Handling and Resilience</h2>

<h3 id="comprehensive-error-handling">Comprehensive Error Handling</h3>

<p>Implement robust error handling that provides meaningful feedback while protecting sensitive information:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">mcp.types</span> <span class="kn">import</span> <span class="n">McpError</span>

<span class="k">class</span> <span class="nc">ErrorCode</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">INVALID_INPUT</span> <span class="o">=</span> <span class="s">"INVALID_INPUT"</span>
    <span class="n">EXTERNAL_API_ERROR</span> <span class="o">=</span> <span class="s">"EXTERNAL_API_ERROR"</span>
    <span class="n">TIMEOUT_ERROR</span> <span class="o">=</span> <span class="s">"TIMEOUT_ERROR"</span>
    <span class="n">RATE_LIMIT_EXCEEDED</span> <span class="o">=</span> <span class="s">"RATE_LIMIT_EXCEEDED"</span>

<span class="k">class</span> <span class="nc">ProductionErrorHandler</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="p">.</span><span class="n">Logger</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
    
    <span class="k">def</span> <span class="nf">handle_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="nb">Exception</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">McpError</span><span class="p">:</span>
        <span class="s">"""Convert exceptions to user-friendly MCP errors"""</span>
        <span class="n">error_id</span> <span class="o">=</span> <span class="n">generate_error_id</span><span class="p">()</span>
        
        <span class="c1"># Log detailed error for debugging
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="n">error</span><span class="p">(</span>
            <span class="sa">f</span><span class="s">"Error </span><span class="si">{</span><span class="n">error_id</span><span class="si">}</span><span class="s"> in </span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">error</span><span class="p">).</span><span class="n">__name__</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>
            <span class="n">exc_info</span><span class="o">=</span><span class="bp">True</span>
        <span class="p">)</span>
        
        <span class="c1"># Return sanitized error to user
</span>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">ValidationError</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">McpError</span><span class="p">(</span>
                <span class="n">code</span><span class="o">=</span><span class="n">ErrorCode</span><span class="p">.</span><span class="n">INVALID_INPUT</span><span class="p">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s">"Invalid input provided"</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"error_id"</span><span class="p">:</span> <span class="n">error_id</span><span class="p">}</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="nb">TimeoutError</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">McpError</span><span class="p">(</span>
                <span class="n">code</span><span class="o">=</span><span class="n">ErrorCode</span><span class="p">.</span><span class="n">TIMEOUT_ERROR</span><span class="p">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s">"Request timed out"</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"error_id"</span><span class="p">:</span> <span class="n">error_id</span><span class="p">}</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">McpError</span><span class="p">(</span>
                <span class="n">code</span><span class="o">=</span><span class="s">"INTERNAL_ERROR"</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s">"An internal error occurred"</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"error_id"</span><span class="p">:</span> <span class="n">error_id</span><span class="p">}</span>
            <span class="p">)</span>
</code></pre></div></div>

<h3 id="circuit-breaker-pattern">Circuit Breaker Pattern</h3>

<p>Implement circuit breakers for external service calls:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Any</span>

<span class="k">class</span> <span class="nc">CircuitState</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">CLOSED</span> <span class="o">=</span> <span class="s">"CLOSED"</span>
    <span class="n">OPEN</span> <span class="o">=</span> <span class="s">"OPEN"</span>
    <span class="n">HALF_OPEN</span> <span class="o">=</span> <span class="s">"HALF_OPEN"</span>

<span class="k">class</span> <span class="nc">CircuitBreaker</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">failure_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">failure_threshold</span> <span class="o">=</span> <span class="n">failure_threshold</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">failure_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">last_failure_time</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">CircuitState</span><span class="p">.</span><span class="n">CLOSED</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">CircuitState</span><span class="p">.</span><span class="n">OPEN</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">_should_attempt_reset</span><span class="p">():</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">CircuitState</span><span class="p">.</span><span class="n">HALF_OPEN</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">"Circuit breaker is OPEN"</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">_on_success</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">_on_failure</span><span class="p">()</span>
            <span class="k">raise</span> <span class="n">e</span>
    
    <span class="k">def</span> <span class="nf">_should_attempt_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">last_failure_time</span> <span class="ow">and</span>
            <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">last_failure_time</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="p">.</span><span class="n">timeout</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_on_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">failure_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">CircuitState</span><span class="p">.</span><span class="n">CLOSED</span>
    
    <span class="k">def</span> <span class="nf">_on_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">failure_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">last_failure_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">failure_count</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="p">.</span><span class="n">failure_threshold</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">CircuitState</span><span class="p">.</span><span class="n">OPEN</span>
</code></pre></div></div>

<h2 id="monitoring-and-observability">Monitoring and Observability</h2>

<h3 id="structured-logging">Structured Logging</h3>

<p>Implement comprehensive logging with structured data:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>

<span class="k">class</span> <span class="nc">StructuredLogger</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">StreamHandler</span><span class="p">()</span>
        <span class="n">handler</span><span class="p">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_json_formatter</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_json_formatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="n">log_entry</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">"timestamp"</span><span class="p">:</span> <span class="n">record</span><span class="p">.</span><span class="n">created</span><span class="p">,</span>
            <span class="s">"level"</span><span class="p">:</span> <span class="n">record</span><span class="p">.</span><span class="n">levelname</span><span class="p">,</span>
            <span class="s">"message"</span><span class="p">:</span> <span class="n">record</span><span class="p">.</span><span class="n">getMessage</span><span class="p">(),</span>
            <span class="s">"module"</span><span class="p">:</span> <span class="n">record</span><span class="p">.</span><span class="n">module</span><span class="p">,</span>
            <span class="s">"function"</span><span class="p">:</span> <span class="n">record</span><span class="p">.</span><span class="n">funcName</span><span class="p">,</span>
            <span class="s">"line"</span><span class="p">:</span> <span class="n">record</span><span class="p">.</span><span class="n">lineno</span>
        <span class="p">}</span>
        
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="s">'extra_data'</span><span class="p">):</span>
            <span class="n">log_entry</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">extra_data</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">log_entry</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_data</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="p">{</span><span class="s">'extra_data'</span><span class="p">:</span> <span class="n">extra_data</span><span class="p">})</span>
    
    <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_data</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="p">{</span><span class="s">'extra_data'</span><span class="p">:</span> <span class="n">extra_data</span><span class="p">})</span>
</code></pre></div></div>

<h3 id="metrics-collection">Metrics Collection</h3>

<p>Implement metrics collection for monitoring server performance:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>
<span class="kn">from</span> <span class="nn">prometheus_client</span> <span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">Histogram</span><span class="p">,</span> <span class="n">Gauge</span>

<span class="k">class</span> <span class="nc">Metrics</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request_count</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span>
            <span class="s">'mcp_requests_total'</span><span class="p">,</span>
            <span class="s">'Total MCP requests'</span><span class="p">,</span>
            <span class="p">[</span><span class="s">'tool'</span><span class="p">,</span> <span class="s">'status'</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">request_duration</span> <span class="o">=</span> <span class="n">Histogram</span><span class="p">(</span>
            <span class="s">'mcp_request_duration_seconds'</span><span class="p">,</span>
            <span class="s">'MCP request duration'</span><span class="p">,</span>
            <span class="p">[</span><span class="s">'tool'</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">active_connections</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span>
            <span class="s">'mcp_active_connections'</span><span class="p">,</span>
            <span class="s">'Number of active MCP connections'</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">record_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">status</span> <span class="o">=</span> <span class="s">'success'</span> <span class="k">if</span> <span class="n">success</span> <span class="k">else</span> <span class="s">'error'</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request_count</span><span class="p">.</span><span class="n">labels</span><span class="p">(</span><span class="n">tool</span><span class="o">=</span><span class="n">tool</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">).</span><span class="n">inc</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request_duration</span><span class="p">.</span><span class="n">labels</span><span class="p">(</span><span class="n">tool</span><span class="o">=</span><span class="n">tool</span><span class="p">).</span><span class="n">observe</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="configuration-management">Configuration Management</h2>

<h3 id="environment-based-configuration">Environment-Based Configuration</h3>

<p>Use environment variables and configuration files for different deployment environments:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseSettings</span>

<span class="k">class</span> <span class="nc">MCPServerConfig</span><span class="p">(</span><span class="n">BaseSettings</span><span class="p">):</span>
    <span class="c1"># Server settings
</span>    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s">"0.0.0.0"</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8000</span>
    <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">False</span>
    
    <span class="c1"># Security settings
</span>    <span class="n">api_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">cors_origins</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="s">"*"</span><span class="p">]</span>
    
    <span class="c1"># External services
</span>    <span class="n">database_url</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">redis_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    
    <span class="c1"># Performance settings
</span>    <span class="n">max_concurrent_requests</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">request_timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
    
    <span class="c1"># Logging
</span>    <span class="n">log_level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s">"INFO"</span>
    <span class="n">log_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s">"json"</span>
    
    <span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
        <span class="n">env_prefix</span> <span class="o">=</span> <span class="s">"MCP_"</span>
        <span class="n">case_sensitive</span> <span class="o">=</span> <span class="bp">False</span>

<span class="c1"># Load configuration from environment
</span><span class="n">config</span> <span class="o">=</span> <span class="n">MCPServerConfig</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="testing-strategies">Testing Strategies</h2>

<h3 id="integration-testing">Integration Testing</h3>

<p>Create comprehensive integration tests for your MCP server:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">from</span> <span class="nn">mcp.testing</span> <span class="kn">import</span> <span class="n">MCPTestClient</span>

<span class="k">class</span> <span class="nc">TestMCPServer</span><span class="p">:</span>
    <span class="o">@</span><span class="n">pytest</span><span class="p">.</span><span class="n">fixture</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MCPTestClient</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_tool_execution_success</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">):</span>
        <span class="s">"""Test successful tool execution"""</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="n">call_tool</span><span class="p">(</span>
            <span class="s">"search_database"</span><span class="p">,</span>
            <span class="p">{</span><span class="s">"query"</span><span class="p">:</span> <span class="s">"test query"</span><span class="p">,</span> <span class="s">"limit"</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
        <span class="p">)</span>
        
        <span class="k">assert</span> <span class="n">response</span><span class="p">.</span><span class="n">success</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">5</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"id"</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_tool_execution_with_invalid_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">):</span>
        <span class="s">"""Test tool execution with invalid input"""</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="n">call_tool</span><span class="p">(</span>
            <span class="s">"search_database"</span><span class="p">,</span>
            <span class="p">{</span><span class="s">"query"</span><span class="p">:</span> <span class="s">""</span><span class="p">,</span> <span class="s">"limit"</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
        <span class="p">)</span>
        
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">response</span><span class="p">.</span><span class="n">success</span>
        <span class="k">assert</span> <span class="n">response</span><span class="p">.</span><span class="n">error</span><span class="p">.</span><span class="n">code</span> <span class="o">==</span> <span class="s">"INVALID_INPUT"</span>
    
    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_rate_limiting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">):</span>
        <span class="s">"""Test rate limiting behavior"""</span>
        <span class="c1"># Make multiple rapid requests
</span>        <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">client</span><span class="p">.</span><span class="n">call_tool</span><span class="p">(</span><span class="s">"search_database"</span><span class="p">,</span> <span class="p">{</span><span class="s">"query"</span><span class="p">:</span> <span class="sa">f</span><span class="s">"query_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">"</span><span class="p">})</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="p">]</span>
        
        <span class="n">responses</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1"># Should have some rate limit errors
</span>        <span class="n">rate_limit_errors</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">responses</span> 
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">Exception</span><span class="p">)</span> <span class="ow">and</span> <span class="s">"rate limit"</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span>
        <span class="p">]</span>
        
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">rate_limit_errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</code></pre></div></div>

<h2 id="deployment-best-practices">Deployment Best Practices</h2>

<h3 id="containerization">Containerization</h3>

<p>Create optimized Docker containers for your MCP server:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">FROM</span><span class="w"> </span><span class="s">python:3.11-slim</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s">base</span>

<span class="c"># Install system dependencies</span>
<span class="k">RUN </span>apt-get update <span class="o">&amp;&amp;</span> apt-get <span class="nb">install</span> <span class="nt">-y</span> <span class="se">\
</span>    gcc <span class="se">\
</span>    <span class="o">&amp;&amp;</span> <span class="nb">rm</span> <span class="nt">-rf</span> /var/lib/apt/lists/<span class="k">*</span>

<span class="c"># Set working directory</span>
<span class="k">WORKDIR</span><span class="s"> /app</span>

<span class="c"># Install Python dependencies</span>
<span class="k">COPY</span><span class="s"> requirements.txt .</span>
<span class="k">RUN </span>pip <span class="nb">install</span> <span class="nt">--no-cache-dir</span> <span class="nt">-r</span> requirements.txt

<span class="c"># Copy application code</span>
<span class="k">COPY</span><span class="s"> . .</span>

<span class="c"># Create non-root user</span>
<span class="k">RUN </span>useradd <span class="nt">--create-home</span> <span class="nt">--shell</span> /bin/bash app <span class="se">\
</span>    <span class="o">&amp;&amp;</span> <span class="nb">chown</span> <span class="nt">-R</span> app:app /app

<span class="k">USER</span><span class="s"> app</span>

<span class="c"># Health check</span>
<span class="k">HEALTHCHECK</span><span class="s"> --interval=30s --timeout=3s --start-period=5s --retries=3 \</span>
    CMD python health_check.py

<span class="c"># Expose port</span>
<span class="k">EXPOSE</span><span class="s"> 8000</span>

<span class="c"># Start application</span>
<span class="k">CMD</span><span class="s"> ["python", "-m", "uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]</span>
</code></pre></div></div>

<h3 id="health-checks">Health Checks</h3>

<p>Implement comprehensive health checks:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">status</span>
<span class="kn">from</span> <span class="nn">fastapi.responses</span> <span class="kn">import</span> <span class="n">JSONResponse</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"/health"</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">health_check</span><span class="p">():</span>
    <span class="s">"""Comprehensive health check endpoint"""</span>
    <span class="n">checks</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"database"</span><span class="p">:</span> <span class="k">await</span> <span class="n">check_database_connection</span><span class="p">(),</span>
        <span class="s">"redis"</span><span class="p">:</span> <span class="k">await</span> <span class="n">check_redis_connection</span><span class="p">(),</span>
        <span class="s">"external_apis"</span><span class="p">:</span> <span class="k">await</span> <span class="n">check_external_services</span><span class="p">(),</span>
    <span class="p">}</span>
    
    <span class="n">all_healthy</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">checks</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">status_code</span> <span class="o">=</span> <span class="n">status</span><span class="p">.</span><span class="n">HTTP_200_OK</span> <span class="k">if</span> <span class="n">all_healthy</span> <span class="k">else</span> <span class="n">status</span><span class="p">.</span><span class="n">HTTP_503_SERVICE_UNAVAILABLE</span>
    
    <span class="k">return</span> <span class="n">JSONResponse</span><span class="p">(</span>
        <span class="n">status_code</span><span class="o">=</span><span class="n">status_code</span><span class="p">,</span>
        <span class="n">content</span><span class="o">=</span><span class="p">{</span>
            <span class="s">"status"</span><span class="p">:</span> <span class="s">"healthy"</span> <span class="k">if</span> <span class="n">all_healthy</span> <span class="k">else</span> <span class="s">"unhealthy"</span><span class="p">,</span>
            <span class="s">"checks"</span><span class="p">:</span> <span class="n">checks</span><span class="p">,</span>
            <span class="s">"timestamp"</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="n">utcnow</span><span class="p">().</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">)</span>
</code></pre></div></div>

<h2 id="conclusion">Conclusion</h2>

<p>Building production-ready MCP servers requires attention to multiple aspects including security, performance, error handling, monitoring, and deployment practices. By following these best practices, you’ll create robust servers that can handle real-world workloads while providing excellent developer and user experiences.</p>

<p>Remember to:</p>

<ul>
  <li><strong>Always prioritize security</strong> with proper authentication and input validation</li>
  <li><strong>Implement comprehensive error handling</strong> with meaningful user feedback</li>
  <li><strong>Monitor your servers</strong> with structured logging and metrics</li>
  <li><strong>Test thoroughly</strong> with both unit and integration tests</li>
  <li><strong>Use configuration management</strong> for different environments</li>
  <li><strong>Plan for scalability</strong> from the beginning</li>
</ul>

<p>As the MCP ecosystem continues to evolve, stay updated with the latest best practices and security recommendations from the community.</p>

    </div>

    <!-- Article Footer -->
    <footer class="post-footer">
      <!-- Tags -->
      
      <div class="post-tags">
        <h4>Tags</h4>
        <div class="tags-list">
          
          <span class="tag">mcp</span>
          
          <span class="tag">best-practices</span>
          
          <span class="tag">production</span>
          
          <span class="tag">security</span>
          
          <span class="tag">performance</span>
          
        </div>
      </div>
      

      <!-- Share Section -->
      <div class="post-share">
        <h4>Share this article</h4>
        <div class="share-buttons">
          <a href="https://twitter.com/intent/tweet?text=Best%20Practices%20for%20Building%20Production-Ready%20MCP%20Servers&url=https://mcp.collabnix.com/pr-preview/pr-44/guides/development/2025/06/26/mcp-production-best-practices.html" 
             target="_blank" rel="noopener" class="share-twitter" title="Share on Twitter">
            <svg viewBox="0 0 24 24" width="20" height="20">
              <path fill="currentColor" d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z"/>
            </svg>
          </a>
          <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://mcp.collabnix.com/pr-preview/pr-44/guides/development/2025/06/26/mcp-production-best-practices.html&title=Best%20Practices%20for%20Building%20Production-Ready%20MCP%20Servers" 
             target="_blank" rel="noopener" class="share-linkedin" title="Share on LinkedIn">
            <svg viewBox="0 0 24 24" width="20" height="20">
              <path fill="currentColor" d="M20.447,20.452H16.893V14.883C16.893,13.555 16.866,11.846 15.041,11.846C13.188,11.846 12.905,13.291 12.905,14.785V20.452H9.351V9H12.765V10.561H12.811C13.288,9.661 14.448,8.711 16.181,8.711C19.782,8.711 20.447,11.081 20.447,14.166V20.452ZM5.337,7.433A2.062,2.062 0 0,1 3.275,5.371A2.062,2.062 0 0,1 5.337,3.309A2.062,2.062 0 0,1 7.399,5.371A2.062,2.062 0 0,1 5.337,7.433ZM7.119,20.452H3.555V9H7.119V20.452ZM22.225,0H1.771C0.792,0 0,0.774 0,1.729V22.271C0,23.227 0.792,24 1.771,24H22.222C23.2,24 24,23.227 24,22.271V1.729C24,0.774 23.2,0 22.222,0H22.225Z"/>
            </svg>
          </a>
          <a href="https://www.facebook.com/sharer/sharer.php?u=https://mcp.collabnix.com/pr-preview/pr-44/guides/development/2025/06/26/mcp-production-best-practices.html" 
             target="_blank" rel="noopener" class="share-facebook" title="Share on Facebook">
            <svg viewBox="0 0 24 24" width="20" height="20">
              <path fill="currentColor" d="M24,12.073C24,5.405 18.627,0 12,0S0,5.405 0,12.073C0,18.1 4.388,23.094 10.125,24V15.563H7.078V12.073H10.125V9.404C10.125,6.369 11.917,4.734 14.658,4.734C15.971,4.734 17.344,4.969 17.344,4.969V7.875H15.833C14.345,7.875 13.875,8.753 13.875,9.66V12.073H17.206L16.671,15.563H13.875V24C19.612,23.094 24,18.1 24,12.073Z"/>
            </svg>
          </a>
          <button class="share-copy" onclick="copyToClipboard()" title="Copy link">
            <svg viewBox="0 0 24 24" width="20" height="20">
              <path fill="currentColor" d="M16,1H4C2.9,1 2,1.9 2,3V17H4V3H16V1M19,5H8C6.9,5 6,5.9 6,7V21C6,22.1 6.9,23 8,23H19C20.1,23 21,22.1 21,21V7C21,5.9 20.1,5 19,5M19,21H8V7H19V21Z"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- Author Bio -->
      <div class="author-bio">
        <div class="author-avatar-large">
          <img src="/pr-preview/pr-44/assets/images/authors/alex-chen.jpg" 
               alt="Alex Chen" loading="lazy">
        </div>
        <div class="author-bio-content">
          <h4>Alex Chen</h4>
          <p class="author-bio-text">
            Alex is a senior developer with 5+ years of experience building AI tooling and MCP integrations. Passionate about clean code, security, and scalable architectures.
          </p>
          
          <div class="author-social">
            
            <a href="https://twitter.com/alexchen_dev" target="_blank" rel="noopener">Twitter</a>
            
            
            <a href="https://github.com/alexchen-dev" target="_blank" rel="noopener">GitHub</a>
            
            
            <a href="https://linkedin.com/in/alexchen-developer" target="_blank" rel="noopener">LinkedIn</a>
            
          </div>
          
        </div>
      </div>
    </footer>

    <!-- Navigation -->
    <nav class="post-navigation">
      
      <div class="nav-previous">
        <a href="/pr-preview/pr-44/getting-started/2025/05/01/introduction-to-mcp.html" class="nav-link">
          <span class="nav-direction">← Previous</span>
          <span class="nav-title">Introduction to Model Context Protocol (MCP)</span>
        </a>
      </div>
      

      
    </nav>
  </div>
</article>

<!-- Related Posts -->
<section class="related-posts">
  <div class="related-posts-container">
    <h3>Related Articles</h3>
    <div class="related-posts-grid">
      
      
      
      
    </div>
  </div>
</section>

<style>
:root {
  --color-primary: #5551ff;
  --color-secondary: #f8f9fa;
  --color-accent: #4CAF50;
  --color-text: #2c3e50;
  --color-text-light: #6c757d;
  --color-border: #e9ecef;
  --color-background: #ffffff;
  --shadow-sm: 0 2px 4px rgba(0,0,0,0.1);
  --shadow-md: 0 4px 8px rgba(0,0,0,0.1);
  --shadow-lg: 0 8px 24px rgba(0,0,0,0.15);
  --border-radius: 12px;
  --transition: all 0.3s ease;
}

.modern-post {
  max-width: none;
  margin: 0;
}

/* Hero Section */
.post-hero {
  background: linear-gradient(135deg, var(--color-primary) 0%, #667eea 100%);
  color: white;
  padding: 3rem 0 4rem;
  position: relative;
  overflow: hidden;
}

.post-hero-content {
  max-width: 800px;
  margin: 0 auto;
  padding: 0 2rem;
  position: relative;
  z-index: 2;
}

.post-breadcrumbs {
  font-size: 0.9rem;
  margin-bottom: 1.5rem;
  opacity: 0.9;
}

.post-breadcrumbs a {
  color: white;
  text-decoration: none;
}

.post-breadcrumbs a:hover {
  text-decoration: underline;
}

.post-breadcrumbs span {
  margin: 0 0.5rem;
}

.post-meta-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.post-category-badge {
  background: rgba(255, 255, 255, 0.2);
  padding: 0.3rem 0.8rem;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 600;
  text-transform: uppercase;
}

.post-date {
  font-size: 0.9rem;
  opacity: 0.9;
}

.post-title {
  font-size: 3rem;
  font-weight: 700;
  line-height: 1.2;
  margin-bottom: 1.5rem;
  background: linear-gradient(45deg, #fff, #e8f4f8);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.post-subtitle {
  font-size: 1.2rem;
  line-height: 1.6;
  opacity: 0.9;
  margin-bottom: 2rem;
}

.post-author-info {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.author-avatar {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  overflow: hidden;
  border: 3px solid rgba(255, 255, 255, 0.3);
}

.author-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.author-name {
  font-weight: 600;
  font-size: 1.1rem;
  display: block;
  margin-bottom: 0.2rem;
}

.author-role {
  font-size: 0.9rem;
  opacity: 0.8;
  display: block;
  margin-bottom: 0.5rem;
}

.post-stats {
  font-size: 0.85rem;
  opacity: 0.7;
}

.post-stats span {
  margin-right: 1rem;
}

.post-featured-image {
  margin-top: 3rem;
  text-align: center;
}

.post-featured-image img {
  max-width: 100%;
  height: auto;
  border-radius: var(--border-radius);
  box-shadow: var(--shadow-lg);
}

/* Content Wrapper */
.post-content-wrapper {
  max-width: 800px;
  margin: 0 auto;
  padding: 3rem 2rem;
  position: relative;
}

/* Table of Contents */
.table-of-contents {
  position: sticky;
  top: 2rem;
  float: right;
  width: 250px;
  margin-left: 2rem;
  margin-bottom: 2rem;
  background: var(--color-secondary);
  border-radius: var(--border-radius);
  padding: 1.5rem;
  font-size: 0.9rem;
}

.table-of-contents h4 {
  margin: 0 0 1rem 0;
  color: var(--color-text);
  font-size: 1rem;
}

.table-of-contents ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.table-of-contents li {
  margin-bottom: 0.5rem;
}

.table-of-contents a {
  color: var(--color-text-light);
  text-decoration: none;
  transition: var(--transition);
}

.table-of-contents a:hover {
  color: var(--color-primary);
}

/* Post Content */
.post-content {
  font-size: 1.1rem;
  line-height: 1.8;
  color: var(--color-text);
}

.post-content h2 {
  font-size: 1.8rem;
  margin: 2.5rem 0 1.25rem;
  color: var(--color-text);
  scroll-margin-top: 2rem;
}

.post-content h3 {
  font-size: 1.5rem;
  margin: 2rem 0 1rem;
  color: var(--color-text);
  scroll-margin-top: 2rem;
}

.post-content h4 {
  font-size: 1.25rem;
  margin: 1.75rem 0 0.75rem;
  color: var(--color-text);
  scroll-margin-top: 2rem;
}

.post-content p {
  margin-bottom: 1.5rem;
}

.post-content blockquote {
  border-left: 4px solid var(--color-primary);
  padding: 1rem 1.5rem;
  margin: 2rem 0;
  background: var(--color-secondary);
  border-radius: 0 var(--border-radius) var(--border-radius) 0;
  font-style: italic;
}

.post-content pre {
  background: #282c34;
  border-radius: var(--border-radius);
  padding: 1.5rem;
  margin: 2rem 0;
  overflow-x: auto;
  color: #abb2bf;
}

.post-content code {
  font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
  font-size: 0.9em;
}

.post-content p code {
  background: #f1f1f1;
  padding: 0.2rem 0.4rem;
  border-radius: 4px;
  color: var(--color-text);
}

.post-content img {
  max-width: 100%;
  height: auto;
  border-radius: var(--border-radius);
  margin: 2rem 0;
  box-shadow: var(--shadow-md);
}

/* Post Footer */
.post-footer {
  margin-top: 4rem;
  padding-top: 3rem;
  border-top: 1px solid var(--color-border);
}

.post-tags {
  margin-bottom: 3rem;
}

.post-tags h4 {
  font-size: 1.2rem;
  margin-bottom: 1rem;
  color: var(--color-text);
}

.tags-list {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.tag {
  background: var(--color-secondary);
  color: var(--color-text);
  padding: 0.4rem 0.8rem;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: 500;
}

/* Share Buttons */
.post-share {
  margin-bottom: 3rem;
}

.post-share h4 {
  font-size: 1.2rem;
  margin-bottom: 1rem;
  color: var(--color-text);
}

.share-buttons {
  display: flex;
  gap: 1rem;
}

.share-buttons a,
.share-buttons button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  color: white;
  transition: var(--transition);
  border: none;
  cursor: pointer;
  text-decoration: none;
}

.share-twitter { background: #1da1f2; }
.share-linkedin { background: #0077b5; }
.share-facebook { background: #4267B2; }
.share-copy { background: var(--color-text-light); }

.share-buttons a:hover,
.share-buttons button:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

/* Author Bio */
.author-bio {
  display: flex;
  gap: 1.5rem;
  padding: 2rem;
  background: var(--color-secondary);
  border-radius: var(--border-radius);
  margin-bottom: 3rem;
}

.author-avatar-large {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  overflow: hidden;
  flex-shrink: 0;
}

.author-avatar-large img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.author-bio-content h4 {
  margin: 0 0 0.5rem 0;
  color: var(--color-text);
}

.author-bio-text {
  color: var(--color-text-light);
  margin-bottom: 1rem;
  line-height: 1.6;
}

.author-social {
  display: flex;
  gap: 1rem;
}

.author-social a {
  color: var(--color-primary);
  text-decoration: none;
  font-weight: 500;
}

.author-social a:hover {
  text-decoration: underline;
}

/* Post Navigation */
.post-navigation {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
  margin-bottom: 3rem;
}

.nav-link {
  display: block;
  padding: 1.5rem;
  background: white;
  border: 1px solid var(--color-border);
  border-radius: var(--border-radius);
  text-decoration: none;
  color: var(--color-text);
  transition: var(--transition);
}

.nav-link:hover {
  transform: translateY(-3px);
  box-shadow: var(--shadow-lg);
}

.nav-direction {
  font-size: 0.85rem;
  color: var(--color-text-light);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  display: block;
  margin-bottom: 0.5rem;
}

.nav-title {
  font-weight: 600;
  font-size: 1.1rem;
  line-height: 1.3;
  display: block;
}

.nav-next .nav-link {
  text-align: right;
}

/* Related Posts */
.related-posts {
  background: var(--color-secondary);
  padding: 4rem 0;
  margin-top: 4rem;
}

.related-posts-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 2rem;
}

.related-posts h3 {
  text-align: center;
  font-size: 2rem;
  margin-bottom: 3rem;
  color: var(--color-text);
}

.related-posts-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 2rem;
}

.related-post-card {
  background: white;
  border-radius: var(--border-radius);
  overflow: hidden;
  box-shadow: var(--shadow-md);
  transition: var(--transition);
}

.related-post-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-lg);
}

.related-post-image {
  height: 200px;
  overflow: hidden;
}

.related-post-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: var(--transition);
}

.related-post-card:hover .related-post-image img {
  transform: scale(1.05);
}

.related-post-content {
  padding: 1.5rem;
}

.related-post-category {
  background: var(--color-primary);
  color: white;
  padding: 0.3rem 0.6rem;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
}

.related-post-content h4 {
  margin: 1rem 0 0.5rem 0;
  font-size: 1.2rem;
}

.related-post-content h4 a {
  color: var(--color-text);
  text-decoration: none;
  transition: var(--transition);
}

.related-post-content h4 a:hover {
  color: var(--color-primary);
}

.related-post-content p {
  color: var(--color-text-light);
  margin-bottom: 1rem;
  line-height: 1.5;
}

.related-post-content time {
  font-size: 0.85rem;
  color: var(--color-text-light);
}

/* Mobile Responsiveness */
@media (max-width: 1024px) {
  .table-of-contents {
    display: none;
  }
}

@media (max-width: 768px) {
  .post-title {
    font-size: 2.2rem;
  }
  
  .post-hero {
    padding: 2rem 0 3rem;
  }
  
  .post-hero-content {
    padding: 0 1rem;
  }
  
  .post-content-wrapper {
    padding: 2rem 1rem;
  }
  
  .post-navigation {
    grid-template-columns: 1fr;
  }
  
  .author-bio {
    flex-direction: column;
    text-align: center;
  }
  
  .related-posts-grid {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 480px) {
  .post-title {
    font-size: 1.8rem;
  }
  
  .post-author-info {
    flex-direction: column;
    text-align: center;
    gap: 0.5rem;
  }
  
  .share-buttons {
    justify-content: center;
  }
}

/* Copy to clipboard notification */
.copy-notification {
  position: fixed;
  top: 20px;
  right: 20px;
  background: var(--color-primary);
  color: white;
  padding: 1rem 1.5rem;
  border-radius: var(--border-radius);
  box-shadow: var(--shadow-lg);
  z-index: 1000;
  opacity: 0;
  transform: translateX(100%);
  transition: var(--transition);
}

.copy-notification.show {
  opacity: 1;
  transform: translateX(0);
}
</style>

<script>
// Copy to clipboard functionality
function copyToClipboard() {
  const url = window.location.href;
  navigator.clipboard.writeText(url).then(() => {
    showNotification('Link copied to clipboard!');
  }).catch(() => {
    // Fallback for older browsers
    const textArea = document.createElement('textarea');
    textArea.value = url;
    document.body.appendChild(textArea);
    textArea.select();
    document.execCommand('copy');
    document.body.removeChild(textArea);
    showNotification('Link copied to clipboard!');
  });
}

function showNotification(message) {
  // Remove existing notification
  const existing = document.querySelector('.copy-notification');
  if (existing) {
    existing.remove();
  }
  
  // Create new notification
  const notification = document.createElement('div');
  notification.className = 'copy-notification';
  notification.textContent = message;
  document.body.appendChild(notification);
  
  // Show notification
  setTimeout(() => notification.classList.add('show'), 100);
  
  // Hide notification
  setTimeout(() => {
    notification.classList.remove('show');
    setTimeout(() => notification.remove(), 300);
  }, 3000);
}

// Generate Table of Contents
document.addEventListener('DOMContentLoaded', function() {
  const headings = document.querySelectorAll('.post-content h2, .post-content h3, .post-content h4');
  const tocContent = document.getElementById('toc-content');
  
  if (headings.length > 0 && tocContent) {
    const tocList = document.createElement('ul');
    
    headings.forEach((heading, index) => {
      // Add ID to heading if it doesn't have one
      if (!heading.id) {
        heading.id = `heading-${index}`;
      }
      
      const listItem = document.createElement('li');
      const link = document.createElement('a');
      link.href = `#${heading.id}`;
      link.textContent = heading.textContent;
      link.style.paddingLeft = `${(parseInt(heading.tagName.substring(1)) - 2) * 15}px`;
      
      listItem.appendChild(link);
      tocList.appendChild(listItem);
    });
    
    tocContent.appendChild(tocList);
  } else if (tocContent) {
    // Hide TOC if no headings
    document.querySelector('.table-of-contents').style.display = 'none';
  }
});
</script>
  </main>
  
  <footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-info">
        <h3>Docker MCP Community Portal</h3>
        <p>A community-driven resource for Docker Model Context Protocol.</p>
        <p>&copy; 2025 MCP Community Portal. All rights reserved.</p>
      </div>
      <div class="footer-links">
        <h4>Resources</h4>
        <ul>
          <li>
            <a href="https://github.com/ajeetraina/docker-mcp-portal" target="_blank">
              <i class="fab fa-github"></i> GitHub Repository
            </a>
          </li>
          <li>
            <a href="https://collabnix.com" target="_blank">
              <i class="fas fa-globe"></i> Collabnix Community
            </a>
          </li>
          <li>
            <a href="https://github.com/ajeetraina/docker-mcp-portal/blob/main/CONTRIBUTING.md" target="_blank">
              <i class="fas fa-code-branch"></i> Contribute to MCP Portal
            </a>
          </li>
          <li>
            <a href="https://hub.docker.com/u/mcp" target="_blank">
              <i class="fab fa-docker"></i> MCP on Docker Hub
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</footer>
  
  <!-- ClipboardJS for copy functionality -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.10/clipboard.min.js"></script>
  
  <!-- Syntax highlighting -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  
  <!-- Custom scripts -->
  <script src="/pr-preview/pr-44/assets/js/filter.js"></script>
  <script src="/pr-preview/pr-44/assets/js/github-stars.js"></script>
  <script src="/pr-preview/pr-44/assets/js/docker-downloads.js"></script>
  <script src="/pr-preview/pr-44/assets/js/code-formatter.js"></script>
  
  <script>
    // Initialize clipboard.js
    document.addEventListener('DOMContentLoaded', function() {
      var clipboard = new ClipboardJS('.btn-copy');
      
      clipboard.on('success', function(e) {
        var button = e.trigger;
        var originalText = button.innerHTML;
        
        button.innerHTML = '<i class="fas fa-check"></i> Copied!';
        button.classList.add('copied');
        
        setTimeout(function() {
          button.innerHTML = originalText;
          button.classList.remove('copied');
        }, 2000);
        
        e.clearSelection();
      });
      
      // Initialize syntax highlighting
      document.querySelectorAll('pre code').forEach((el) => {
        hljs.highlightElement(el);
      });
    });
  </script>
</body>
</html>